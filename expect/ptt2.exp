#!/usr/bin/expect
set timeout 60

set f [open "/tmp/1.txt"]
set commands [split [read $f] "\n"]
close $f

#exit

  spawn ssh -oBatchMode=no -oStrictHostKeyChecking=no bbsu@ptt.cc

set f [open "/tmp/id"]
  gets $f BBS_ID
close $f
set f [open "/tmp/pwd"]
   gets $f BBS_PW 
close $f

expect "æˆ–ä»¥ new è¨»å†Š: " { send "$BBS_ID\r" }
expect "è«‹è¼¸å…¥æ‚¨çš„å¯†ç¢¼" { send "$BBS_PW\r" }
expect "è«‹æŒ‰ä»»æ„éµç¹¼çºŒ" 
send "\r"

expect "oodbye" 
sleep 1
send "f\r"

# é€²å…¥ test çœ‹æ¿
expect "20" 
send "113\r\r" 

expect "è«‹æŒ‰ä»»æ„éµç¹¼çºŒ" 
send "\r"

# é€²å…¥ test çœ‹æ¿  end

#send -- "\[C"
send -- ""

expect ") "
send "1\r"

sleep 1
send -- "è¼¸å…¥ test 7\r"
foreach cmd $commands {
  send "$cmd\r"
sleep 1
}

# é›¢é–‹ç·¨è¼¯ç•«é¢
send -- ""
send -- "s"
sleep 1
send -- "\r"

# å­˜æª”
sleep 1
send -- "0\r"

expect "è«‹æŒ‰ä»»æ„éµç¹¼çºŒ"
send -- "\r"

interact
